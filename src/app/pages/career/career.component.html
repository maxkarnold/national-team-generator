<div class="2xl:flex">
  <div class="m-8 overflow-x-auto" *ngIf="currentTransferOptions.length > 0">
    <h2 class="text-2xl mb-4 text-center">Season {{ currentSeason.year }} Options</h2>
    <legend>Click a club to choose them</legend>
    <table class="table table-compact table-zebra">
      <thead>
        <tr>
          <th>Club</th>
          <th>Play Time</th>
          <th>Transfer Offer</th>
          <th>Wage (per week)</th>
        </tr>
      </thead>
      <tr
        *ngFor="let transfer of currentTransferOptions"
        class="cursor-pointer capitalize hover:bg-base-200"
        (click)="simulateSeason(transfer)">
        <td>
          <div class="flex items-center space-x-3">
            <div class="avatar">
              <div class="mask mask-square w-12 h-16">
                <img [src]="transfer.club.logo" [alt]="transfer.club.clubName" />
              </div>
            </div>
            <div>
              <div class="font-bold capitalize">{{ transfer.club.clubName }}</div>
              <div class="text-sm opacity-50 uppercase">{{ transfer.club.league }}</div>
            </div>
          </div>
        </td>
        <td>{{ transfer.playingTime }}</td>
        <td>
          <div class="flex flex-col">
            <div class="font-bold">{{ transfer.transferFee | currency: 'EUR':'symbol':'1.0-0' }}</div>
            <div class="text-sm opacity-50 capitalize">{{ transfer.transferType }}</div>
          </div>
        </td>
        <td>{{ transfer.wage | currency: 'EUR':'symbol':'1.0-0' }}</td>
      </tr>
    </table>
  </div>

  <div *ngIf="finalStats" class="flex-1 m-8 overflow-x-auto">
    <h2 class="text-3xl mb-4 text-center">{{ finalStats.length > 1 ? 'Last 5 Careers' : 'Career Overview' }}</h2>
    <table class="table table-zebra table-compact m-8">
      <thead>
        <th>Years Active</th>
        <th>Longest Served Club</th>
        <th>Rating</th>
        <th>APP</th>
        <th>GOALS</th>
        <th>ASSISTS</th>
        <th>AVG RATING</th>
        <th>TOTAL EARNINGS (â‚¬)</th>
      </thead>
      <tbody>
        <tr *ngFor="let career of finalStats">
          <td>
            <div class="flex flex-col">
              <div class="font-bold">{{ career.seasons }}</div>
              <div class="text-sm opacity-50 capitalize">{{ career.yearsActive }}</div>
            </div>
          </td>
          <td class="flex items-center capitalize">
            <div class="flex items-center space-x-3">
              <div class="avatar">
                <div class="mask mask-square w-12 h-16">
                  <img [src]="career.longestServedClub?.logo" [alt]="career.longestServedClub?.clubName" />
                </div>
              </div>
              <div>
                <div class="font-bold capitalize">{{ career.longestServedClub?.clubName }}</div>
                <div class="text-sm opacity-50 uppercase">{{ career.longestServedClub?.league }}</div>
              </div>
            </div>
          </td>
          <td *ngIf="career.score">
            <div class="cursor-pointer" (click)="myModal.showModal()">
              <star-rating
                [starType]="'svg'"
                [rating]="career.score.totalScore"
                [readOnly]="true"
                [getHalfStarVisible]="isHalfStar"
                space="between"></star-rating>
            </div>
            <dialog #myModal class="modal">
              <div class="modal-box">test</div>
            </dialog>
            <!-- <app-star-rating-dialog [career]="career" #myModal></app-star-rating-dialog> -->
          </td>
          <td>
            {{ career.totalApps }}
          </td>
          <td>
            {{ career.totalGoals }}
          </td>
          <td>
            {{ career.totalAssists }}
          </td>
          <td>
            {{ career.avgRating }}
          </td>
          <td>
            {{ career.totalEarnings | currency: 'EUR':'symbol':'1.0-0' }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="overflow-x-auto flex-1 m-8">
    <table class="table table-xs xl:table-md table-zebra">
      <thead>
        <tr>
          <th>Career Stats</th>
        </tr>
        <tr>
          <th *ngFor="let header of tableHeaders">{{ header }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let season of seasons" class="">
          <td>{{ season.year }}</td>
          <td>{{ season.age }}</td>
          <td>
            <div class="flex items-center space-x-3">
              <div class="avatar">
                <div class="mask mask-square w-12 h-14">
                  <img [src]="season.currentTeam?.club?.logo" [alt]="season.currentTeam?.club?.clubName" />
                </div>
              </div>
              <div>
                <div class="font-bold capitalize">{{ season.currentTeam?.club?.clubName }}</div>
                <div class="text-sm opacity-50 uppercase">{{ season.currentTeam?.club?.league }}</div>
              </div>
            </div>
          </td>
          <td class="capitalize">
            {{
              season.currentTeam?.transferType === 'transfer'
                ? (season.currentTeam?.transferFee | currency: 'EUR':'symbol':'1.0-0')
                : season.currentTeam?.transferType === 'loan'
                ? 'loan'
                : ''
            }}
          </td>
          <td>{{ season.appearances }}</td>
          <td>{{ season.goals }}</td>
          <td>{{ season.assists }}</td>
          <td>{{ season.avgRating === 0 ? 'N/A' : season.avgRating.toFixed(1) }}</td>
          <td>{{ season.currentTeam?.wage | currency: 'EUR':'symbol':'1.0-0' }}</td>
          <td class="capitalize">{{ season.currentTeam?.playingTime }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
