<div class="2xl:flex">
  <div class="m-8 overflow-x-auto" *ngIf="currentTransferOptions.length > 0">
    <h2 class="text-2xl mb-4 text-center">Season {{ currentSeason.year }} ( Age: {{ currentSeason.age }} )</h2>
    <legend>Click a club to choose them</legend>
    <table class="table table-xs xl:table-md table-zebra">
      <thead class="uppercase">
        <tr>
          <th>Club</th>
          <th>Play Time</th>
          <th>Transfer Offer</th>
          <th>Wage (per week)</th>
        </tr>
      </thead>
      <tr
        *ngFor="let transfer of currentTransferOptions"
        class="cursor-pointer capitalize hover:bg-base-200"
        (click)="simulateSeason(transfer)">
        <td>
          <div class="flex items-center space-x-3">
            <div class="avatar">
              <div class="mask mask-square w-12 h-16">
                <img [src]="transfer.club.logo" [alt]="transfer.club.clubName" />
              </div>
            </div>
            <div>
              <div class="font-bold capitalize">{{ transfer.club.clubName }}</div>
              <div class="text-sm opacity-50 uppercase">{{ transfer.club.league }}</div>
              <app-star-rating [rating]="transfer.club.clubRating / 200 * 5"></app-star-rating>
            </div>
          </div>
        </td>
        <td>{{ transfer.playingTime }}</td>
        <td>
          <div class="flex flex-col">
            <div class="font-bold">{{ transfer.transferFee | currency: 'EUR':'symbol':'1.0-0' }}</div>
            <div class="text-sm opacity-50 capitalize">{{ transfer.transferType }}</div>
          </div>
        </td>
        <td>{{ transfer.wage | currency: 'EUR':'symbol':'1.0-0' }}</td>
      </tr>
    </table>
  </div>

  <div *ngIf="finalStats.length && currentTransferOptions.length < 1" class="flex-1 m-8 overflow-x-auto">
    <h2 class="text-3xl mb-4 text-center">{{ finalStats.length > 1 ? 'Last 5 Careers' : 'Career Overview' }}</h2>
    <table class="table table-zebra table-xs xl:table-md m-8">
      <thead class="uppercase">
        <th>Years Active</th>
        <th>Most Appearances</th>
        <th>Rating</th>
        <th>APP</th>
        <th>GOALS</th>
        <th>ASSISTS</th>
        <th>AVG RATING</th>
        <th>TOTAL EARNINGS (€)</th>
      </thead>
      <tbody>
        <tr *ngFor="let career of finalStats">
          <td>
            <div class="flex flex-col">
              <div class="font-bold">{{ career.seasons }}</div>
              <div class="text-sm opacity-50 capitalize">{{ career.yearsActive }}</div>
            </div>
          </td>
          <td class="flex items-center capitalize">
            <div class="flex items-center space-x-3">
              <div class="avatar">
                <div class="mask mask-square w-12 h-16">
                  <img [src]="career.longestServedClub?.logo" [alt]="career.longestServedClub?.clubName" />
                </div>
              </div>
              <div>
                <div class="font-bold capitalize">{{ career.longestServedClub?.clubName }}</div>
                <div class="text-sm opacity-50 uppercase">{{ career.longestServedClub?.league }} - {{ career.longestServedClub?.clubApps }}</div>
              </div>
            </div>
          </td>
          <td *ngIf="career.score">
            <div class="cursor-pointer" (click)="starRatingModal.showModal(); consoleLogCareer(career)">
              <app-star-rating [rating]="career.score.totalScore"></app-star-rating>
            </div>
            <dialog #starRatingModal class="modal">
              <div class="modal-box">
                <form method="dialog">
                  <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>
                </form>
                <h3 class="text-xl">Star Rating Details</h3>
                <label>Ability</label>
                <p>
                  <app-star-rating [rating]="career.score.abilityScore"></app-star-rating>
                </p>
                <label>Club</label>
                <p>
                  <app-star-rating [rating]="career.score.peakClubScore"></app-star-rating>
                </p>
                <label>League</label>
                <p>
                  <app-star-rating [rating]="career.score.avgLeagueScore"></app-star-rating>
                </p>
                <label>Availability</label>
                <p>
                  <app-star-rating [rating]="career.score.availabilityScore"></app-star-rating>
                </p>
                <label>Scoring</label>
                <p>
                  <app-star-rating [rating]="career.score.goalScore"></app-star-rating>
                </p>
              </div>
              <form method="dialog" class="modal-backdrop">
                <button>close</button>
              </form>
            </dialog>
          </td>
          <td>
            {{ career.totalApps }}
          </td>
          <td>
            {{ career.totalGoals }}
          </td>
          <td>
            {{ career.totalAssists }}
          </td>
          <td>
            {{ career.avgRating }}
          </td>
          <td>
            {{ career.totalEarnings | currency: 'EUR':'symbol':'1.0-0' }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="overflow-x-auto flex-1 m-8">
    <table class="table table-xs xl:table-md table-zebra">
      <thead class="uppercase">
        <tr>
          <th>Career Stats</th>
        </tr>
        <tr>
          <th *ngFor="let header of tableHeaders">{{ header }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let season of seasons">
          <td>{{ season.year }}</td>
          <td>{{ season.age }}</td>
          <td>
            <div class="flex items-center space-x-3">
              <div class="avatar">
                <div class="mask mask-square w-12 h-14">
                  <img [src]="season.currentTeam?.club?.logo" [alt]="season.currentTeam?.club?.clubName" />
                </div>
              </div>
              <div>
                <div class="font-bold capitalize">{{ season.currentTeam?.club?.clubName }}</div>
                <div class="text-sm opacity-50 uppercase">{{ season.currentTeam?.club?.league }}</div>
              </div>
            </div>
          </td>
          <td class="capitalize">
            {{
              season.currentTeam?.transferType === 'transfer'
                ? (season.currentTeam?.transferFee | currency: 'EUR':'symbol':'1.0-0')
                : season.currentTeam?.transferType === 'loan'
                ? 'loan'
                : ''
            }}
          </td>
          <td>{{ season.appearances }}</td>
          <td>{{ season.goals }}</td>
          <td>{{ season.assists }}</td>
          <td>{{ season.avgRating === 0 ? 'N/A' : season.avgRating.toFixed(1) }}</td>
          <td>{{ season.currentTeam?.wage | currency: 'EUR':'symbol':'1.0-0' }}</td>
          <td class="capitalize">{{ season.currentTeam?.playingTime }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
